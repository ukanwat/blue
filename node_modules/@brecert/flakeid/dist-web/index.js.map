{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["export default class FlakeId {\r\n    constructor({ seq = 0, mid = 1, timeOffset = 0, lastTime = 0 } = {}) {\r\n        this.seq = seq;\r\n        this.mid = mid % 1023;\r\n        this.timeOffset = timeOffset;\r\n        this.lastTime = lastTime;\r\n    }\r\n    gen() {\r\n        const time = Date.now(), bTime = (time - this.timeOffset).toString(2);\r\n        // get the sequence number\r\n        if (this.lastTime == time) {\r\n            this.seq += 1;\r\n            if (this.seq > 4095) {\r\n                this.seq = 0;\r\n                // make system wait till time is been shifted by one millisecond\r\n                while (Date.now() <= time) { }\r\n            }\r\n        }\r\n        else {\r\n            this.seq = 0;\r\n        }\r\n        this.lastTime = time;\r\n        // make sure sequence length will be constant\r\n        const bSeq = this.seq.toString(2).padStart(12, \"0\");\r\n        const bMid = this.mid.toString(2).padStart(10, \"0\");\r\n        const bid = bTime + bMid + bSeq;\r\n        let id = \"\";\r\n        for (let i = bid.length; i > 0; i -= 4) {\r\n            id = parseInt(bid.substring(i - 4, i), 2).toString(16) + id;\r\n        }\r\n        return BigInt(`0x${id}`);\r\n    }\r\n}\r\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"AAAe,MAAM,OAAO,CAAC;IACzB,WAAW,CAAC,EAAE,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,CAAC,EAAE,UAAU,GAAG,CAAC,EAAE,QAAQ,GAAG,CAAC,EAAE,GAAG,EAAE,EAAE;QACjE,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;KAC5B;IACD,GAAG,GAAG;QACF,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,EAAE,EAAE,KAAK,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC;;QAEtE,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,EAAE;YACvB,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;YACd,IAAI,IAAI,CAAC,GAAG,GAAG,IAAI,EAAE;gBACjB,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;AAC7B,AAEA,aAAa;SACJ;aACI;YACD,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;SAChB;QACD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;;QAErB,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;QACpD,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;QACpD,MAAM,GAAG,GAAG,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC;QAChC,IAAI,EAAE,GAAG,EAAE,CAAC;QACZ,KAAK,IAAI,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE;YACpC,EAAE,GAAG,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;SAC/D;QACD,OAAO,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;KAC5B;CACJ;;;;"}