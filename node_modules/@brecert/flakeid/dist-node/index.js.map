{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["export default class FlakeId {\r\n    constructor({ seq = 0, mid = 1, timeOffset = 0, lastTime = 0 } = {}) {\r\n        this.seq = seq;\r\n        this.mid = mid % 1023;\r\n        this.timeOffset = timeOffset;\r\n        this.lastTime = lastTime;\r\n    }\r\n    gen() {\r\n        const time = Date.now(), bTime = (time - this.timeOffset).toString(2);\r\n        // get the sequence number\r\n        if (this.lastTime == time) {\r\n            this.seq += 1;\r\n            if (this.seq > 4095) {\r\n                this.seq = 0;\r\n                // make system wait till time is been shifted by one millisecond\r\n                while (Date.now() <= time) { }\r\n            }\r\n        }\r\n        else {\r\n            this.seq = 0;\r\n        }\r\n        this.lastTime = time;\r\n        // make sure sequence length will be constant\r\n        const bSeq = this.seq.toString(2).padStart(12, \"0\");\r\n        const bMid = this.mid.toString(2).padStart(10, \"0\");\r\n        const bid = bTime + bMid + bSeq;\r\n        let id = \"\";\r\n        for (let i = bid.length; i > 0; i -= 4) {\r\n            id = parseInt(bid.substring(i - 4, i), 2).toString(16) + id;\r\n        }\r\n        return BigInt(`0x${id}`);\r\n    }\r\n}\r\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":";;;;AAMc,MAAO,OAAP,CAAc;EAM1B,WAAA,CAAY;IAAE,GAAG,GAAG,CAAR;IAAW,GAAG,GAAG,CAAjB;IAAoB,UAAU,GAAG,CAAjC;IAAoC,QAAQ,GAAG;MAAqB,EAAhF,EAAkF;SAC3E,GAAL,GAAW,GAAX;SACK,GAAL,GAAW,GAAG,GAAG,IAAjB;SACK,UAAL,GAAkB,UAAlB;SACK,QAAL,GAAgB,QAAhB;;;EAGF,GAAG,GAAA;UACK,IAAI,GAAG,IAAI,CAAC,GAAL,EAAb;UACA,KAAK,GAAG,CAAC,IAAI,GAAG,KAAK,UAAb,EAAyB,QAAzB,CAAkC,CAAlC,CADR,CADC;;QAKG,KAAK,QAAL,IAAiB,IAArB,EAA2B;WACpB,GAAL,IAAY,CAAZ;;UAEI,KAAK,GAAL,GAAW,IAAf,EAAqB;aACd,GAAL,GAAW,CAAX,CADmB;AAKpB;KARH,MASO;WACA,GAAL,GAAW,CAAX;;;SAGG,QAAL,GAAgB,IAAhB,CAlBC;;UAqBK,IAAI,GAAG,KAAK,GAAL,CAAS,QAAT,CAAkB,CAAlB,EAAqB,QAArB,CAA8B,EAA9B,EAAkC,GAAlC,CAAb;UACM,IAAI,GAAG,KAAK,GAAL,CAAS,QAAT,CAAkB,CAAlB,EAAqB,QAArB,CAA8B,EAA9B,EAAkC,GAAlC,CAAb;UACM,GAAG,GAAG,KAAK,GAAG,IAAR,GAAe,IAA3B;QAEI,EAAE,GAAG,EAAT;;SAEK,IAAI,CAAC,GAAG,GAAG,CAAC,MAAjB,EAAyB,CAAC,GAAG,CAA7B,EAAgC,CAAC,IAAI,CAArC,EAAwC;MACtC,EAAE,GAAG,QAAQ,CAAC,GAAG,CAAC,SAAJ,CAAc,CAAC,GAAG,CAAlB,EAAqB,CAArB,CAAD,EAA0B,CAA1B,CAAR,CAAqC,QAArC,CAA8C,EAA9C,IAAoD,EAAzD;;;WAGK,MAAM,CAAC,KAAK,EAAE,EAAR,CAAb;;;;;;;"}